puts [0,1e13].map{|x|File.read("in.txt").split("\n\n").map{_1.scan(/\d+/)}.map{|l|l.each_with_index.map{|j,i|i>3?j.to_i+x:j.to_i}}.sum{|m|(a=(m[5]*(o=(c=m[0].lcm(m[1]))/m[1])-m[4]*(e=c/m[0]))/(m[3]*o-m[2]*e).to_f)== a.to_i&& (b=(m[4]-a*m[2])/m[0])== b.to_i ? (a+b*3):0}.to_i}
puts require('matrix')&&[0,10**13].map{|t|File.read("in.txt").split("\n\n").map{|s, a=s.scan(/\d+/).map(&:to_i)|Matrix[a[4..].map{_1+t}]/Matrix[(a[..1]),a[2..3]]}.sum{|s|s.any?{_1!=_1.to_i}?0:3*s[0,0]+s[0,1]}.to_i}