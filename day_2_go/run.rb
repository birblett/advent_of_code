puts File.open("in.txt") { |file, b=0| file.map { |l| l.split.map(&:to_i) }.each { |arr| ((ARGV.include?("2") ? -1 : arr.length)..arr.length).each { |i, pos=[1,2,3], neg=[-1,-2,-3]| (b += 1 and break) if ((d = (d = (i > 0 ? arr[...i] : []) + (i < arr.length ? arr[i + 1..] : [])).each_with_index.reduce([]) {|out, (v, j)| d[j + 1] ? out.push(d[j + 1] - v) : out }) - pos).length == 0 or (d - neg).length == 0 } } and b }